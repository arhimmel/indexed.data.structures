<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<messageSchema package="com.rsm.message.nasdaq.itch.v4_1"
               id="2"
               semanticVersion="5.2"
               description="NASDAQ BinaryFile Schema"
               byteOrder="bigEndian">
    <types>
        <composite name="messageHeader" description="Message identifiers and length of message root">
            <type name="blockLength" primitiveType="uint16"/>
            <type name="templateId" primitiveType="uint16"/>
            <type name="schemaId" primitiveType="uint16"/>
            <type name="version" primitiveType="uint16"/>
        </composite>
        <composite name="groupSize" semanticType="NumInGroup">
            <type name="blockLength" primitiveType="uint16"/>
            <type name="numInGroup" primitiveType="uint8"/>
        </composite>
        <composite name="varDataEncoding">
            <type name="length" primitiveType="uint16"/>
            <!--<type name="varData" primitiveType="int8"/>-->
            <type name="varData" primitiveType="int8" length="0" characterEncoding="ASCII" semanticType="data"/>
        </composite>


        <type name="secondsType" primitiveType="uint32" description="Reflects the number of seconds past midnight that the Timestamp message was generated."/>
        <type name="nanosecondsType" primitiveType="uint64" description="Reflects the number of nanoseconds since the most recent Timestamp-Seconds message that the payload message was generated."/>
        <type name="timestamp" primitiveType="uint32" timeUnit="nanosecond" semanticType="UTCTimestamp"/>
        <type name="seconds" primitiveType="uint32" timeUnit="seconds"/>
        <type name="sequence" primitiveType="uint64" description="Sequence number for the event in the stream."/>
        <type name="symbol" length="5" primitiveType="char"/>

        <composite name="streamHeader">
            <type name="timestampNanos" primitiveType="uint64" timeUnit="nanosecond" semanticType="UTCTimestamp"/>
            <type name="major" primitiveType="char" description="Major event type"/>
            <type name="minor" primitiveType="char" description="Minor event type"/>
            <type name="source" primitiveType="uint64" description="Source of the event"/>
            <type name="id" primitiveType="uint32" description="Id of the source"/>
            <type name="ref" primitiveType="uint32" description="Reference of the source"/>
        </composite>

        <!-- itch specific messages -->
        <enum name="ITCHMessageType" encodingType="char" semanticType="char">
            <validValue name="TIMESTAMP_SECONDS">T</validValue><!--84-->
            <validValue name="SYSTEM_EVENT">S</validValue><!--83-->
            <validValue name="STOCK_DIRECTORY">R</validValue><!--82-->
            <validValue name="STOCK_TRADING_ACTION">H</validValue><!---->
            <validValue name="REG_SHO_SHORT_SALE">Y</validValue><!---->
            <validValue name="MARKET_PARTICIPANT_POSITION">L</validValue><!---->
        </enum>
<!--        <composite name="timestampSecondsType" id="84" description="Timestamp Seconds Message">
            <type name="messageType" primitiveType="char" semanticType="ITCHMessageType"/>
            <type name="seconds" primitiveType="uint32" timeUnit="seconds"/>
        </composite>-->
<!--        <composite name="systemEventType" id="83" description="System Event Message">&lt;!&ndash; S &ndash;&gt;
            <type name="messageType" primitiveType="char" semanticType="ITCHMessageType"/>
            <type name="timestamp" primitiveType="uint32" timeUnit="timestamp"/>
            <type name="eventCode" primitiveType="int8"/>
        </composite>-->
        <!--<composite name="stockDirectoryType" id="82" description="Stock Directory Message">&lt;!&ndash; R &ndash;&gt;-->
            <!--<type name="messageType" primitiveType="char" semanticType="ITCHMessageType"/>-->
            <!--<type name="nanoseconds" primitiveType="uint32" timeUnit="timestamp"/>-->
            <!--<type name="stock" primitiveType="int8"/>-->
        <!--</composite>-->
    </types>

    <!-- TimestampSeconds -->
    <message name="TimestampSecondsMessage" id="84" description="TimestampSeconds"><!-- T -->
        <!-- payload -->
        <field name="messageType" id="1" type="ITCHMessageType"/>
        <field name="seconds" id="2" type="seconds" timeUnit="seconds"/>
    </message>
    <message name="TimestampSecondsCommand" id="1084" description="TimestampSeconds Command">
        <field name="streamHeader" id="1" type="streamHeader"/>
        <!-- payload -->
        <field name="messageType" id="1" type="ITCHMessageType"/>
        <field name="seconds" id="2" type="seconds" timeUnit="seconds"/>
    </message>
    <message name="TimestampSecondsEvent" id="2084" description="TimestampSeconds Event">
        <field name="sequence" id="1" type="sequence"/>
        <field name="streamHeader" id="2" type="streamHeader"/>
        <!-- payload -->
        <field name="messageType" id="1" type="ITCHMessageType"/>
        <field name="seconds" id="2" type="seconds" timeUnit="seconds"/>
    </message>

    <!-- SystemEvent -->
    <message name="SystemEventMessage" id="83" description="SystemEvent"><!-- S -->
        <!-- payload -->
        <field name="messageType" id="1" type="ITCHMessageType"/>
        <field name="timestamp" id="3" type="timestamp" timeUnit="timestamp"/>
        <field name="eventCode" id="4" type="char"/>
    </message>
    <message name="SystemEventCommand" id="1083" description="TimestampSeconds Command">
        <field name="streamHeader" id="1" type="streamHeader"/>
        <!-- payload -->
        <field name="messageType" id="1" type="ITCHMessageType"/>
        <field name="timestamp" id="3" type="timestamp" timeUnit="timestamp"/>
        <field name="eventCode" id="4" type="char"/>
    </message>
    <message name="SystemEventEvent" id="2083" description="TimestampSeconds Event">
        <field name="sequence" id="1" type="sequence"/>
        <field name="streamHeader" id="2" type="streamHeader"/>
        <!-- payload -->
        <field name="messageType" id="1" type="ITCHMessageType"/>
        <field name="timestamp" id="3" type="timestamp" timeUnit="timestamp"/>
        <field name="eventCode" id="4" type="char"/>
    </message>

    <!-- StockDirectory -->
    <message name="StockDirectoryMessage" id="82" description="StockDirectory"><!-- R -->
        <!--<field name="payload" id="1" type="systemEventType"/>-->
        <field name="messageType" id="1" type="ITCHMessageType"/>
        <field name="nanoseconds" id="5" type="timestamp" timeUnit="timestamp"/>
        <field name="stock" id="6" type="symbol"/>
    </message>
    <message name="StockDirectoryCommand" id="1082" description="StockDirectory Command">
        <field name="streamHeader" id="1" type="streamHeader"/>
        <!--<field name="payload" id="2" type="systemEventType"/>-->
        <field name="messageType" id="1" type="ITCHMessageType"/>
        <field name="nanoseconds" id="5" type="timestamp" timeUnit="timestamp"/>
        <field name="stock" id="6" type="symbol"/>
    </message>
    <message name="StockDirectoryEvent" id="2082" description="StockDirectory Event">
        <field name="sequence" id="1" type="sequence"/>
        <field name="streamHeader" id="2" type="streamHeader"/>
        <!--<field name="payload" id="3" type="systemEventType"/>-->
        <field name="messageType" id="1" type="ITCHMessageType"/>
        <field name="nanoseconds" id="5" type="timestamp" timeUnit="timestamp"/>
        <field name="stock" id="6" type="symbol"/>
    </message>


</messageSchema>
